<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.agileboot.domain.biz.balance.db.BalanceLogMapper">

    <select id="log" resultType="com.agileboot.domain.biz.balance.dto.CustomerLog">
        select l.create_time, l.amount, a.product from biz_balance_log l left join  biz_balance_log_att a on l.id = a.log_id
        where l.customer_id = #{customerId}
        <if test="type != null and type != ''">
            and l.type = #{type}
        </if>
        ORDER BY l.create_time DESC
    </select>
</mapper>
